{% macro datatable(path=null,newPath=null,show =null,edit=null,remove=null,columns=null) %}
    <script type="text/javascript" src="{{ asset('bundles/benmachatemplate/js/lib/moment/moment-with-locales.min.js') }}"></script>
    <script src="{{ asset('bundles/benmachatemplate/js/lib/datatables-net/datatables.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/benmachatemplate/js/lib/datatables-net/responsive-2.1.0/js/dataTables.responsive.js') }}" type="text/javascript"></script>

    {% set columns = DatatableRaw(columns,show,edit,remove) %}
    <script>
        $(document).ready(function () {

            var table = $('#datatable').DataTable({
                "dom": 'Bfrtip',
                "select": true,
                "buttons": [
                    {%- if newPath is not null -%}
                    {
                        text: '{{ 'New'|trans({},'global') }}',
                        className: "btn-success",
                        action: function() {
                            location.href = '{{ path(newPath) }}';
                        }
                    },
                    {%- endif -%}

                    {%- if remove is not null -%}
                    "selectNone",
                    "selectAll",
                    {
                        text: '{{ 'Remove'|trans({},'global') }}',
                        className: "btn-danger",
                        init: function ( dt, node, config ) {
                            var that = this;
                            dt.on( 'select.dt.DT deselect.dt.DT', function () {
                                that.enable( dt.rows( { selected: true } ).any() );
                            } );
                            this.disable();
                        },action: function ( e, dt, node, config ) {
                            alert( 'Button activated' );
                        }
                    },
                    {% endif %}
                    'excel', 'pdf', 'print'
                ],
                "ajax": {
                    url: "{{ path(path) }}",
                    data: {
                        /*join:[{
                            "join": "VoitureBundle:Voiture",
                            "alias": 'v',
                            "condition": "t.voiture = v.id"
                        },{
                            "join": "ConfigurationBundle:EntretientType",
                            "alias": 'e',
                            "condition": "t.entretienstype = e.id"
                        }],
                        hiddenColumn:[{
                            name:'e.action',
                            data:'e_action'
                        },{
                            name:'v.matricule',
                            data:'v_matricule'
                        },{
                            name:'v.serie',
                            data:'v_serie'
                        }]*/
                    }
                },
                "processing": true,
                "pagingType": "full_numbers",
                "serverSide": true,
                "sAjaxDataProp": "data",
                "pageLength": 100,
                "searching": true,
                "deferRender": true,
                "scrollY": 500,
                "scrollX": true,
                "scroller": {
                    "loadingIndicator": true
                },
                "columns": [{% for column in columns %}{ {% for key, data in column %}{% if key == "render" %}"{{ key }}": {{ data|raw }},{% else %}"{{ key }}":"{{ data|raw }}",{% endif %}{% endfor %}},{% endfor %}]
            });
            table.on( 'deselect', function ( e, dt, type, indexes ) {
                console.log(e)
                console.log(dt)
                console.log(type)
                console.log(indexes)
            });
            table.on( 'select', function ( e, dt, type, indexes ) {
                //table.rows( $('#datatable tr.active') ).remove().draw();
                console.log(e)
                console.log(dt)
                console.log(type)
                console.log(indexes)
            });
            setTimeout(function () {
                table.draw();
            }, 50);

        });
    </script>
{% endmacro %}

{% macro flatpicker() %}
    <script type="text/javascript" src="{{ asset('bundles/benmachatemplate/js/lib/flatpickr/flatpickr.min.js') }}"></script>
    <script>
        /* ==========================================================================
          Datepicker
          ========================================================================== */

        $(document).ready(function () {
            $('.flatpickr').flatpickr();
            $("#flatpickr-disable-range").flatpickr({
                disable: [
                    {
                        from: "2016-08-16",
                        to: "2016-08-19"
                    },
                    "2016-08-24",
                    new Date().fp_incr(30) // 30 days from now
                ]
            });
        });
    </script>
{% endmacro %}